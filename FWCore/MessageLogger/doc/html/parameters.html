<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<BODY bgcolor="FFFFFF">
<title>
          CMS MessageLogger: Configuring the MessageLogger Service
</title>

<center>
<h1> <img src="header-public.gif" align="center"> </h1>

<font color=red>
<h1>CMS MessageLogger Service
<br> 
Configuring the MessageLogger Service</h1>
</font>
</center>

<p>
The <a href="MessageLogger.html">CMS MessageLogger Service </a> 
is meant to allow code to log 
messages to a unified message logging 
and statistics facility.  
While reasonable default behaviors are provided,  
the behavior of the MessageLogger can be adjusted via lines in the 
job's configuration file (.cfg).  
<p>
<ul>
<li> <a href="#Concepts"> Message Logging Concepts </a>
<li> <a href="#example"> Example .cfg File </a>
<li> <a href="#complete"> Examples of all MessageLogger Parameters </a> 
</ul>
<p>

<a name="concepts">
<h2> Message Logging Concepts </h2>

To understand what sort of flexibility is available, it is useful to 
be familiar with the following concepts:
<ul>
<li><font color=blue><b> Destination
  </b></font>
  <ul>
    The MessageLogger is capable of routing messages to multiple 
    <b>Destination</b>s.  
    The behavior -- the nature of which messages would appear 
    and which would be ignored -- can be controlled for each destination.  
    At present, two types of <b>destination</b>s are supported:  
    <ol>
    <li> Output files, the names of which can be specified in the job's
    .cfg file.  (If the file specified already exists, the messages will
    be appended to the file.)
    <li> Streams <font color=blue><b>cerr</b></font> and 
    <font color=blue><b>cout</b></font>.  (Because our parameter set
    syntax treats these names specially, creation of an output <em>file</em>
    named cerr or cout is not supported.)
    </ol>
  </ul>
<li><font color=blue><b> Message ID
  </b></font>
  <ul>
  Each message is given an ID when issued.  For example, several messages
  with different detailed content could all be of type <b>TrackingProblem</b>.
  The behavior for message with a given ID can be controlled.
  </ul>
<li><font color=blue><b> Severity
  </b></font>
  <ul>
  <font color=blue>LogDebug</font>, 
  <font color=blue>edm::LogWarning</font>, 
  <font color=blue>edm::LogInfo</font>, and
  <font color=blue>edm::LogError</font> produce messages with severity 
   <font color=blue>DEBUG</font>, 
   <font color=blue>WARNING</font>, 
  <font color=blue>INFO</font>, and
  <font color=blue>ERROR</font> respectively.  
  These are ordered with <font color=blue>DEBUG</font> as the lowest
  severity and <font color=blue>ERROR</font> as the highest.  
  </ul>
<li><font color=blue><b> Threshold
  </b></font>
  For any given destination, the .cfg file can specify that every
  message with a severity lower than a given <font color=blue>threshold</font>
  shall be ignored.  Setting a threshold to <font color=blue>DEBUG</font> is
  valid but moot, since no messages will have severity lower than that.
  <ul>
  </ul>
<li><font color=blue><b> Limit
  </b></font>
  <ul>
  For each message id, or for messages in general, or for a specified severity
  level, the .cfg file can instruct the logger to ignore messages after some
  number (the <font color=blue>limit</font>) have been encountered.  
  (Actually, beyond the applicable limit, an occasional further message will
  appear, based on an exponential backoff.  Thus, if the a limit is set at 
  5, and 100 messages of that id are issued, then that destination will react
  to the messages number 1, 2, 3, 4, 5, 10, 15, 25, 45, and 85.) 
  </ul>
<li><font color=blue><b> Timespan
  </b></font>
  When a limit is set, it is possible to specify that if no occurences of that
  type of message are seen in some number of seconds (the 
  <font color=blue>timespan</font>), then the count toward that limit is to 
  be reset.  Thus if you wish to supress most of the thousands of warnings of
  some type expected at startup, but would like to know if another one happens
  after a gap of ten minutes, this can be specified as a timespan of 600.
  <ul>
  </ul> 
</ul>
<p>
The typical user may not be interested in specifying limits of how many times
messages of types will be displayed.  By default, the MessageLogger service
will output to each destination every messages meeting the severity threshold 
criteria specific for that destination.  In fact, the user need not specify
any thresholds; then every message will be output.  And if the user does not
specify any destinations, then a single destination of cerr is assumed.
<p>

In the near future, concepts for establishing and/or controlling a destination
involving the <font color=blue> log4cplusplus </font> service may also
be listed here.

<a name="example">
<h2> Example .cfg File </h2>

The following is an example .cfg file, requesting the MessageLogger
Service, setting up some destinations, and specifying some thresholds
for how "severe" a message must be in order for it to appear in each
destination.

<pre>
process TEST = {

  <a href="serviceML.html">service = MessageLogger</a> {
    <a href="files.html">vstring destinations = </a>{   <a href="filename.html">"detailedInfo.txt"</a>
                             , <a href="filename.html">"critical.txt"</a>
                             , <a href="cout.html">"cout"</a>
                             , <a href="cerr.html">"cerr"</a>
                      }
    <a href="filename.html">PSet critical.txt</a>     = { <a href="errorthreshold.html">string setThreshold = "ERROR"</a>   }
    <a href="filename.html">PSet detailedInfo.txt</a> = { <a href="infothreshold.html">string setThreshold = "INFO"</a>    } 
    <a href="cerr.html">PSet cerr</a>             = { <a href="warnthreshold.html">string setThreshold = "WARNING"</a> }
  }
  path p = { myAnalysisModule }
  module myAnalysisModule = ModuleThatIssuesMessages { }
  source = EmptySource {untracked int32 maxEvents = 5}
}
</pre>


<a name="complete">
<h2> Examples of all MessageLogger Parameters </h2>

The following is an example .cfg file, requesting the MessageLogger
Service, setting up some destinations, and specifying some  
choices for thresholds, and for limits and timespans applicable 
to severities, to specific
missage ID's, and to all non-specified (default) message ID's.
<p>
The .cfg file contains not only a list of files, but also a list of message 
ID's that the author wishes to control individually.
<p>
This example documents all options available for configuration of MessageLogger
behavior.  
If further features are made available, they will be reflected by additional 
illustrations in this example.
<pre>
process TEST = {

  <a href="serviceMLc.html">service = MessageLogger {</a>
    <a href="destinations.html">vstring destinations = { "detailedInfo.txt"</a>
			   <a href="destinations.html">, "critical.txt"</a>
			   <a href="destinations.html">, "jobdebug.txt"</a>
			   <a href="destinations.html">, "anotherfile.txt"</a>
			   <a href="destinations.html">, "cout"</a>
			   <a href="destinations.html">, "cerr"</a>
			   <a href="destinations.html">}</a>
    <a href="mIDs.html">vstring messageIDs = { "unimportant"</a>
			 <a href="mIDs.html">, "trkwarning"</a>
 			 <a href="mIDs.html">, "serious_matter"</a>
                         <a href="mIDs.html">}</a>
    <a href="destname.html">PSet critical.txt = {</a> <a href="thresh.html">string threshold = "ERROR"</a>
                              <a href="default.html">PSet default = {</a> <a href="limits.html">int32 limit</a>    = 10
			                       <a href="limits.html">int32 timespan = 180</a>
					     <a href="default.html">}</a>
			      PSet serious_matter = { int32 limit = 100000 }
                        }
    <a href="destname.html">PSet detailedInfo.txt = {</a>  <a href="thresh.html">string threshold = "INFO"</a>
			      <a href="default.html">PSet default        = {</a> <a href="limits.html">int32 limit    =  10</a>
					              <a href="limits.html">int32 timespan =  60</a>
					            <a href="default.html">}</a>
			      <a href="severity.html">PSet WARNING        = </a>{ <a href="limits.html">int32 limit    = 100</a>
			                              <a href="limits.html">int32 timespan =  60</a> 
					            }
			      <a href="severity.html">PSet ERROR          = </a>{ <a href="limits.html">int32 limit    = 100</a>
			                              <a href="limits.html">int32 timespan =  60</a> 
					            }
			      <a href="mIDs.html">PSet trkwarning</a>     = { <a href="limits.html">int32 limit    = 20</a>
			                              <a href="limits.html">int32 timespan = 1200</a>
						    }
			      <a href="mIDs.html">PSet unimportant</a>    = { <a href="limits.html">int32 limit    = 5</a> }
			      <a href="mIDs.html">PSet serious_matter</a> = { <a href="limits.html">int32 limit    = 1000000</a> }
                            }
    PSet cerr     = { <a href="thresh.html">string threshold = "WARNING"</a> }

    <a href="destname.html">PSet jobdebug.txt =     {</a> PSet default        = { <a href="limits.html">int32 limit    = 1000000</a> <a href="mIDs.html">}</a>
                            }
    <a href="destname.html">PSet anotherfile.txt =  {</a> PSet serious_matter = { <a href="limits.html">int32 limit    = 1000</a> } 
                            }
    PSet default = { int32 limit    = 10
                     int32 timespan = 60
		   }
  }
  path p = { sendSomeMessages }
  module sendSomeMessages = MessageLoggerClient { }
  source = EmptySource {untracked int32 maxEvents = 10}
}
</pre>


-->

<p><center>
<img src="bar.gif"></center>

<p><center>
<a href="http://www.uscms.org/SoftwareComputing/index.html">
USCMS Software and Computing Home Page </a> -
<a href="MessageLogger.html">CMS MessageLogger Service Page</a>
</center>

<p>
      <hr>
      <address><a href="mailto:mf@fnal.gov">Mark Fischler</a></address>
<!-- hhmts start -->
Last modified: November 24, 2005
<!-- hhmts end -->
</body>
