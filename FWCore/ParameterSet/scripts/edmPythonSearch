#! /usr/bin/env python

from FWCore.ParameterSet.TreeCrawler import getImportTree, Color
import sys, os

try:
    filename = sys.argv[2]
    pattern = sys.argv[1]
except:
    raise StandardError("Usage: edmPythonSearch <target> <fileName>")

sys.path.append(os.environ["PWD"])
path = sys.path[:]

# get the import tree
importTree = getImportTree(filename, path)  

# search the tree
result = []
importTree.search(pattern,result)

# sort the output by file name
result.sort(key= lambda x: x.filename)

# dump to screen
for item in result:
    print "%s (line: %s) : %s"  %(item.filename, item.number, item.line.replace(pattern,Color.hilight+pattern+Color.none) )
                






